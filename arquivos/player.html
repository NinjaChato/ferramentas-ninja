<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Jogando... | Ferramentas Ninja</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }
        #game-container {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

    <div id="game-container"></div>

    <script>
        function webretroEmbed(node, path, queries) {
            node.innerHTML = '';
            var frame = document.createElement("iframe");
            frame.setAttribute('allow', 'fullscreen');
            frame.style = "border: none; display: block; width: 100%; height: 100%;";
            
            if (queries.rom) {
                var link = document.createElement("a");
                // CORREÇÃO FINAL: O caminho agora é relativo à localização do player.html.
                // Como player.html e a pasta roms estão ambos dentro de /arquivos/,
                // o caminho correto a partir do player.html é simplesmente "roms/".
                link.href = "roms/" + queries.rom;
                queries.rom = link.href;
            }
            
            frame.src = path + "?" + Object.entries(queries).map(i => i.map(i => i && encodeURIComponent(i))).map(i => i[1] ? i.join("=") : i[0]).join("&");
            node.appendChild(frame);
            
            return frame;
        }

        window.addEventListener('load', () => {
            const gameContainer = document.getElementById('game-container');
            const params = new URLSearchParams(window.location.search);
            
            const core = params.get('core');
            const rom = params.get('rom');

            if (core && rom) {
                const webretroPath = "https://binbashbanana.github.io/webretro/";
                webretroEmbed(gameContainer, webretroPath, { core: core, rom: rom });
            } else {
                document.body.innerHTML = "<p style='color: white; text-align: center; padding-top: 2rem;'>Erro: Jogo não encontrado.</p>";
            }
        });
    </script>

</body>
</html>
